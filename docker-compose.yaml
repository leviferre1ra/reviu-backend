version: '3.9'

services:
  reviu-api:
    build: .
    container_name: reviu-api
    ports:
      - "8081:8080"
    env_file:
      - .env   # ‚Üê carrega tudo do arquivo .env
    environment:
      spring.datasource.url: ${DB_URL}
      spring.datasource.username: ${DB_USER}
      spring.datasource.password: ${DB_PASSWORD}
      api.security.token.secret: ${SECRET_KEY_TOKEN}

      spring.mail.username: ${EMAIL}
      spring.mail.password: ${EMAIL_PASSWORD}

      cloudinary.cloud.name: ${CLOUDINARY_CLOUD_NAME}
      cloudinary.api.key: ${CLOUDINARY_API_KEY}
      cloudinary.api.secret: ${CLOUDINARY_API_SECRET}

      gemini.api.key: ${GEMINI_API_KEY}

    depends_on:
      - reviu-db

  reviu-db:
    image: postgres:16
    container_name: reviu-db
    environment:
      POSTGRES_DB: reviu
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
    ports:
      - "5433:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
